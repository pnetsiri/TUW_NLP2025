Highlights Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach Iye Szin Ang, Martin Johannes Findl, Elisabeth Hauzinger, Klaus Philipp Sedlazeck, Jyrki Savolainen, Ronald Bakker, Robert Galler, Elmar Rueckert • Raman spectroscopy enables automated mineral identification. • Weighted mineral composition system determines rock types. • Machine learning framework incorporates geological expertise. ar Xiv:2510.13937v1 [cs.CE] 15 Oct 2025 • Knowledge-infused ML pipeline facilitates automated mineral-to-rock classification. Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach Iye Szin Anga,∗, Martin Johannes Findlb, Elisabeth Hauzingerc, Klaus Philipp Sedlazeckb, Jyrki Savolainene, Ronald Bakkere, Robert Gallerc and Elmar Rueckerta a Chair of Cyber-Physical-Systems, Montanuniversität Leoben, Franz Josef-Straße 18, 8700 Leoben , Austria b Chair of Waste Processing Technology and Waste Management, Montanuniversität Leoben, Franz Josef-Straße 18, 8700 Leoben , Austria c Chair of Subsurface Engineering, Montanuniversität Leoben, Franz Josef-Straße 18, 8700 Leoben , Austria d LUT-kauppakorkeakoulu, Yliopistonkatu 34, 53850 Lappeenranta , Finland e Chair of Resource Mineralogy, Montanuniversität Leoben, Franz Josef-Straße 18, 8700 Leoben , Austria A R T I C L E I N F O A B S T R A C T Keywords: RRUFF Knowledge-infused machine learn- ing Deep learning Rock type classification Automated rock classification from mineral composition presents a significant challenge in geological applications, with critical implications for material recycling, resource management, and industrial processing. While existing methods using One-dimensional Convolutional Neural Network (1D-CNN) excel at mineral identification through Raman spectroscopy, the crucial step of determining rock types from mineral assemblages remains unsolved, particularly because the same minerals can form different rock types depending on their proportions and formation conditions. This study presents a novel knowledge-enhanced deep learning approach that integrates geological domain expertise with spectral analysis. The performance of five machine learning methods were evaluated out of which the 1D-CNN and its uncertainty-aware variant demonstrated excellent mineral classification performance (98.37±0.006% and 97.75±0.010% respectively). The integrated system’s evaluation on rock samples revealed variable performance across lithologies, with optimal results for limestone classification but reduced accuracy for rocks sharing similar mineral assemblages. These findings not only show critical challenges in automated geological classification systems but also provide a methodological framework for advancing material characterization and sorting technologies. Rock classification and characterization are fundamental processes in the construction and mining industries, particularly for material recycling and sustainable resource management . Accurate identification and analysis of rock types facilitate optimized resource utilization, enhance operational efficiency, and contribute to environmentally responsible practices. Traditional rock classification is primarily based on expert petrographic analysis, which inte- grates macroscopic observations, microscopic examinations, and manual mineral identification, often supplemented by chemical and/or mineralogical compositional data. However, automated approaches based on mineral composition present unique opportunities in applications that require automated, rapid and accurate classification. This study establishes a systematic framework for automated rock classification that focuses on three representative rock types that are both geologically significant and economically important: granite, sandstone, and limestone. These rocks were selected based on three key criteria: (1) their widespread occurrence in the earth’s crust, (2) their economic iye.ang@unileoben.ac.at (I.S. Ang); martin.findl@unileoben.ac.at (M.J. Findl) ORCID(s): Iye Szin Ang et al.: Preprint submitted to Elsevier Page 1 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach significance in the construction, energy, and mineral industries, and (3) their distinct mineralogical compositions that make them ideal candidates for automated classification systems. Although existing mineral identification methods achieve high accuracy (>96%) using Raman spectroscopy, there is a fundamental methodological gap in automated classification of rock types from these mineral assemblages. Consequently, the crucial step of automatically determining the rock types of these mineral assemblages remains an unresolved challenge. This study addresses the question: How can an automated system to accurately classify various rock types based on mineral assemblages identified through Raman spectroscopy be developed? To the best of our knowledge, this work presents the first systematic approach to automatically classify rock types directly from Raman- identified mineral assemblages. A mineral-to-rock deduction classification system using Raman spectroscopic data was developed and evaluated to address this classification challenge. Raman spectroscopy was selected for its non-destructive analytical capabilities and its ability to provide distinct molecular fingerprints for different minerals, making it particularly suitable for mineral-based rock classification. The system was initially validated with granite before being expanded to sandstone and limestone. These rocks present varying mineralogical complexities, allowing for a systematic evaluation of the classification approach. By starting with this controlled scope, the potential for automated classification can be systematically assessed before expanding to more complex scenarios. This approach combines a One-dimensional Convolutional Neural Network (1D-CNN) with domain-expert rules in a baseline system, leveraging both data-driven learning and established geological knowledge. An uncertainty- aware variant (1D-CNN-UNK) was also explored, designed to handle ambiguous cases and potential unknown mineral assemblages. Through this focused investigation, foundational insights for developing more comprehensive systems capable of handling multiple rock types in automated settings are aimed to be established. The primary contributions of this research are summarized as follows: 1. An integrated framework that combines a One-dimensional Convolutional Neural Network (1D-CNN) with a knowledge-enhanced expert system is proposed. This hybrid approach enables automated mineral identification while incorporating domain expertise through systematic knowledge integration. Using both data-driven learning and established geological knowledge, the framework addresses the limitations of traditional expert systems, which often rely solely on predefined rules or heuristics. weighting system is developed. This system accounts for the variations of mineral assemblages and their relative abundances in different geological settings, providing a more robust classification framework compared to Iye Szin Ang et al.: Preprint submitted to Elsevier Page 2 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach traditional binary classification approaches. The methodology enhances classification accuracy by considering the nuanced compositional differences that are often overlooked in simpler models. database, structured according to expert-designed rock composition templates. This validation methodology ensures geological validity through systematic sampling of diagnostic mineral assemblages, expert-verified compositional relationships, and high-quality spectral data from standardized sources. The dataset’s design and the validation process are described in detail to underscore the rigor and reliability of the findings. since its early laser-based implementations . The integration of artificial intelligence (AI) has transformed spectral data processing and analysis by enabling the use of advanced machine learning algorithms that can handle large volumes of spectral data, leading to improved pattern recognition and classification capabilities. This transformation has resulted in more data being processed efficiently, better image processing techniques, and the development of comprehensive spectral databases. For example, AI-driven Raman spectroscopy has been successfully applied in the automated identification of minerals in geological samples, significantly enhancing the efficiency and accuracy of mineralogical studies . The development of spectral databases has been crucial in advancing mineral identification through Raman spectroscopy, as it has enabled the creation of standardized reference spectra for thousands of minerals. The RRUFF project can be regarded as one of the cornerstones of this domain, providing quality-controlled data, detailed crystallographic information, and documentation of sample origins and conditions. This standardized repository has been used for various applications, from portable gemstone identification systems to machine learning and deep learning approaches . Recent developments have further expanded its utility through high-throughput computational methods and open-source analysis tools . Progress in machine learning has transformed the analysis of Raman spectrum data. Qi et al. provide a comprehensive review of these advances, documenting the progression from traditional statistical methods to more sophisticated deep learning approaches. Among these methods, 1D-CNN have emerged as particularly effective architectures for spectral data analysis , demonstrating excellent performance across various spectroscopic applications including chemical substance identification, molecular structure analysis, and material characterization. The practical application of automated Raman analysis extends to various industrial settings, particularly in sustainable resource management. Resch et al. demonstrated in their study of tunnel excavation materials that the proper characterization and classification of excavated materials could allow their recycling as high-value raw Iye Szin Ang et al.: Preprint submitted to Elsevier Page 3 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach materials. Their work emphasizes not only the need for rapid material characterization and reliable identification methods but also the potential for automated systems to support sustainable construction practices through improved material recycling. Despite these advances, existing research has focused primarily on mineral-level identification through Raman spectroscopy and machine learning. Although these methods excel at identifying individual minerals, they seem to face fundamental limitations when applied to rock type classification. This is due to the fact that rocks are composite materials formed by varying combinations and proportions of minerals: the same minerals can occur in different proportions to form entirely distinct rock types. For example, both granite and sandstone contain mainly quartz and feldspar, but a granite is an igneous rock formed by magma crystallization, while a sandstone is a sedimentary rock formed by the compaction of mineral grains. Their different formation processes result in distinct textures and structures that define them as separate rock types, even though they share common minerals. Current research trends focus on enhancing mineral identification through improved data preprocessing and validation methodologies, yet there remains a critical gap in the literature: the lack of automated systems that can deduce rock types from identified mineral assemblages. The remainder of this paper is structured as follows: Section 3 describes the methodology, including the development of the integrated framework and the quantitative methodology for rock type classification Section 4 presents the results of the validation experiments and discusses the implications of the findings. Finally, Section 5 concludes the paper and suggests future research directions. A rock is a naturally occurring solid aggregate composed of minerals, fragments of minerals or rocks, remnants of organisms, or, in some cases, non-mineral substances. They typically comprise one or more rock-forming minerals and develop as a result of their specific geological setting. This study presents a systematic methodology for mineral assemblage-based rock classification using Raman spectroscopy, focusing specifically on the identification of three different rock types: granite, sandstone, and limestone. Our approach integrates 1D-CNN with knowledge-guided systems to create a robust classification framework. The methodology encompasses four key components: (1) a classification framework that establishes the theoretical foundation for mineral-based rock type identification, (2) systematic dataset collection and generation procedures, (3) development and implementation of two distinct mineral classification models: a baseline 1D-CNN approach and an uncertainty-aware model; and (4) a hierarchical confidence- based knowledge-guided system that take advantage of established geological knowledge for final classification decisions. Iye Szin Ang et al.: Preprint submitted to Elsevier Page 4 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach content for the e.g. plutonic rocks (i.e. granite) is determined in relation to their quartz, alkali feldspar and plagioclase contents and normalized to 100 % which places the rock in the corresponding field in the QAPF diagram, i.e. the granite field. Other rock forming mineral, e.g. micas, are not considered in this classification and are consequently neglected. This standardized classification scheme provides the theoretical foundation for the decision trees implemented in our expert system, particularly for granite and other plutonic igneous rock classifications. For sedimentary rocks, such as sandstone and limestone, the classification rules were developed through knowledge elicitation from expert geologists. Sandstone classification is based on the content of the different grains, which are normalized to 100% and plotted in triangular diagrams with the corner points of the quartz - feldspar - lithic rock fragments. Two diagrams are used based on the fine-grained matrix (grain sizes < 0.03 mm) content. Over the years, numerous classification schemes for clastic sediments have been proposed. For sandstones with a grain size of < 2 mm, the scheme originally developed by Krynine (1948) and later refined by Dott (1964) and Pettijohn et al. (1987) has become widely accepted (Okrusch & Frimmel, 2022) . This ternary classification diagram is based on the relative proportions of Q (quartz), F (feldspar), and L (lithic fragments), which are normalized to a total of 100%. Furthermore, variations in matrix content, typically characterized by mean grain sizes of < 30μm, are represented along an axis perpendicular to the ternary diagram. Rocks which contain < 15% matrix are classified as arenites, ≥15% matrix as wacke ≥75% matrix are classified as claystone. We concentrate on our expert developed sandstone (arenite) decision tree on quartzitic/quartz sandstones with a matrix content of 0−15%. Hence, the sandstone decision tree represents quartzarenit, sublitharenit, and subarkose . The typical classification of limestones is based on the calcite-dolomite ratio. With respect to limestone, we concentrate on a typical limestone (< 10% dolomite) and a dolomitic limestone (10 −50% dolomite) . This process incorporated standard sedimentary rock classification schemes, expert field identification practices, practical experience in distinguishing key mineral assemblages, and common textural and compositional indicators. For our mineral-based classification approach, the sandstone classification rules mentioned above were augmented by the presence of characteristic accessory minerals and the relative abundance of matrix materials. Similarly, the limestone classification incorporates carbonate mineral assemblages and common impurities. For granite, no minor compounds are considered in addition to the main minerals. 3.2. Rock Classification Framework The automated classification of rocks from spectral data presents unique computational challenges due to the complex relationship between mineral assemblages and lithological classification. The proposed framework addresses these challenges through an integrated approach that combines spectral analysis with established petrological principles, implemented via a dual-layer classification architecture. Iye Szin Ang et al.: Preprint submitted to Elsevier Page 6 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach where wmaxis the highest weight among all rock types, w2ndis the second highest weight, θcis the confidence threshold (0.7), and θdis the dominance threshold (0.3). The weight calculation for each rock type incorporates the relative proportions of key minerals, as summarized in Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach 3.3. Dataset Collection and Generation The RRUFF database contains approximately 7,000 mineral samples, which represent 3,500 distinct mineral species. This discrepancy arises because multiple samples can belong to the same mineral species, leading to a higher number of samples than species. Our analysis revealed a significant class imbalance, with 1,522 mineral classes containing fewer than five samples and the corresponding spectral data. In this context, a ‘class’ refers to a specific mineral species that our model aims to identify. Given the complexity and breadth of the RRUFF dataset and the fact that no prior study has addressed this specific problem, we chose to start our investigation by focusing on specific rock types and their related minerals. This approach allows us to simplify the initial scope of the study while still addressing a meaningful and practical subset of the data. Rather than employing standard data augmentation techniques that might introduce artifacts, we adopted a geologically-informed sampling strategy. Sampling in this study refers to the process of selecting specific mineral samples from the RRUFF database. Our sampling strategy was geologically-informed, focusing on minerals commonly found in granite, sandstone, and limestone formations (see mineral selections in Figures 2 to 4). This selective approach ensures that our dataset is relevant to real-world field conditions and aligns with our hybrid architecture, which integrates expert knowledge to compensate for limited training samples. This geological context-driven selection reflects both analytical and practical considerations. The use of unoriented spectra aligns with real-world field conditions, where rock samples are not systematically oriented prior to analysis, resulting in typically random crystallographic orientations of the present mineral phases. Rather than employing a purely data-driven approach that might retain overrepresented but geologically irrelevant mineral species, our selection methodology prioritizes the minerals characteristic of these three rock types, regardless of their representation in the database. This selective sampling strategy aligns with our hybrid architecture, where expert knowledge compensates for limited training samples through geological constraints, effectively addressing both the class imbalance challenge and the need for geologically meaningful classifications. Due to this limited sample size, we expanded our dataset using two synthetic data generation methods. First, we applied a PCA-based approach for minerals with larger datasets and second, we used a direct variation method for minerals with limited samples. Our target dataset sizes were determined by applying a 4× multiplication factor to the initial sample counts, resulting in projected totals of 439 samples for minerals associated with granite, 449 for minerals associated with limestone, 515 for minerals associated with sandstone and 123 for other minor minerals. It is important to note that these samples are mineral spectra, not rock samples. The classification of rocks is inferred from the spectral data of their constituent minerals. All spectra were obtained from processed RRUFF data, which typically includes standard preprocessing steps such as background subtraction and peak fitting, though specific processing methods may vary as the database aggregates contributions from multiple research institutions worldwide. Iye Szin Ang et al.: Preprint submitted to Elsevier Page 10 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach The effectiveness of this geological context-driven selection approach was later validated through expert-designed test cases, as detailed in Section 3.5.5. 3.4. Mineral Classification For mineral classification, four machine learning models were implemented and tested: Support Vector Machine (SVM), Random Forest (RF), Multilayer Perceptron (MLP), and two variants of One-dimensional Convolutional Neural Networks (1D-CNN). Each model was trained using an expanded dataset of 1366 mineral samples. Two versions of the 1D-CNN architecture were developed. The base model consists of two convolutional layers (16 and 32 channels) with Re LU activation and max pooling operations. The network processes the input spectra through these layers before passing through two fully connected layers to output predictions for the fourteen mineral classes. To handle unknown minerals, the base architecture was enhanced with an uncertainty-aware version. This model maintains the same structure but incorporates Monte Carlo dropout layers with a rate of 0.3 after each convolutional layer and the first fully connected layer. During inference, 30 stochastic forward passes are performed with enabled dropout layers, allowing the estimation of both the predictive mean and variance for uncertainty quantification. This uncertainty estimation helps identify when the model encounters mineral spectra that do not match the fourteen defined classes. Both models were trained using cross-entropy loss and the Adam optimizer with a learning rate of 0.001. To avoid overfitting, early stopping was implemented with a patience of 20 epochs, which means training was stopped if the validation loss did not improve for 20 consecutive epochs. 3.5. Rule-Based Expert System The expert system was developed to automate rock classification based on Raman spectroscopy point measure- ments, incorporating domain knowledge from mineralogy. The system employs a set of hierarchical rules that evaluate both prediction accuracy and the presence of mineral assemblages characteristic of different rock types. 3.5.1. Knowledge Base and Definitions The knowledge base KBis defined as a quintuple: KB= (G, R, H, P, C) (3) where: • G= {G1, G2, ..., GK} represents K distinct mineral assemblages • R= {R1, R2, ..., RL} denotes L rock type classification rules • H= (V, E) defines the hierarchical decision tree structure Iye Szin Ang et al.: Preprint submitted to Elsevier Page 11 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach • P= {pv|v∈V} comprises classification and composition parameters • C= {C1, C2, ..., CJ} represents both compositional and confidence constraints For any mineral mand group Giwith weight wi, the weighted membership function is defined as: wi if m∈Giand pmin i ≤fi(m) ≤pmax i 0 otherwise (4) μGi(m, wi) = 3.5.2. Compositional Rules and Constraints The confidence-based compositional requirements for each rock type are formalized through constraint functions: Cj(M, Gi, w Rl) = fj(ni, αj, w Rl) ≥βj (5) where • fjrepresents a constraint function • niis the count of minerals from group Giin measurements M • αjis a parameter vector • w Rlis the importance weight for rule Rl • βjdefines the threshold value The classification rule incorporating confidence thresholds is expressed as: ( ⋀ ) ∧Cconf(wmax, w2nd) (6) Rl(M) = j∈l Cj(M, Gij, wij) where Cconf(wmax, w2nd) = (wmax≥θc) ∧(wmax−w2nd≥θd) 3.5.3. Mineral Assemblages Mineral assemblages for each rock type are represented as weighted sets with composition ranges: ARl= {(Gi, wi, [pmin i , pmax i ])|Gi∈G, wi∈, pmin i , pmax i ∈} (7) where wirepresents the diagnostic weight and [pmin i , pmax i ] defines the valid composition range of mineral group Gi. Iye Szin Ang et al.: Preprint submitted to Elsevier Page 12 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach 3.5.4. Weighted Importance Model Given the weighted mineral assemblages ARl, we define the confidence-adjusted probability of a rock type rule Rl given measurements Mas: P(Rl|M) = ∏ wni i⋅δi (8) (Gi,wi,[pmin i ,pmax i ])∈ARl where: • wiis derived from geological composition ranges and importance weights • ni= count(M, Gi) is the number of minerals from group Giin measurements M • δiis an indicator function that equals 1 if pmin i ≤fi(M) ≤pmax i , and 0 otherwise 3.5.5. Evaluation Framework To evaluate the expert system’s performance under the constraints of open-source geological datasets, 10 test cases for each rock type were utilized, specifically designed by an expert geologist. These cases represent both confident and non-confident classification scenarios that occur in real geological settings. For confident cases, mineral assemblages that unambiguously indicate specific rock types were selected, representing typical compositions found in well-documented geological formations. In contrast, non-confident cases were designed with mineral assemblages that clearly indicate different rock types, challenging the system’s classification capabilities. Confusion matrix analysis was used to quantitatively assess classification performance. This analysis measures true positives (correct rock type identification), false positives (incorrect identification of rock type), true negatives (correct rejection of wrong rock type), and false negatives (incorrect rejection of correct rock type). From these measurements, standard performance metrics, including accuracy, precision, recall, and F1-score, were calculated to provide a comprehensive assessment of the system’s classification capabilities. 4. Results & Discussion The experimental evaluation of our mineral assemblage-based classification framework encompasses three key aspects: the performance of individual mineral identification, the efficacy of the integrated rock classification system and the analysis of current limitations. Quantitative results from both the baseline and uncertainty-aware models are presented, followed by a comparative analysis of their performance across a validation set. As highlighted by Resch et al. , excavated materials from tunnel projects have diverse reuse pathways: limestone can serve as raw material for the steel industry and feedstuffs production, soil can be utilized for brick manufacturing, Iye Szin Ang et al.: Preprint submitted to Elsevier Page 13 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach rock dust has applications in agricultural land improvement, and certain rock types yield valuable industrial minerals such as mica for the paint industry. Therefore, accurate classification of rock types is crucial for optimizing the reuse of excavated materials and minimizing environmental impact. 4.1. Mineral classification The performance of different machine learning models for mineral classification was first evaluated. Figure 5 shows the mean accuracy across five-fold cross-validation for SVM, Random Forest, MLP, 1D-CNN, and 1D-CNN-UNK models. The 1D-CNN model achieved the highest accuracy at 98.37%, while the 1D-CNN-UNK model showed slightly lower performance at 97.75%. Both models outperformed the baseline approaches (SVM at 88.43%, Random Forest at 95.85%, and MLP at 96.25%). Although a confusion matrix would provide detailed per-mineral performance, overall accuracy was focused on the main metric, since the performance of the integrated system is the primary concern. Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach 4.2. Integrated System Performance (a) knowledge-guided 1D-CNN (b) uncertainty-aware knowledge-guided 1D-CNN Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach the classification accuracy decreases when processing complex mineral assemblages within whole rock samples (ΔF1sandstone= −0.19). Third, the expert system rules, despite incorporating established geological constraints, demonstrate limited effectiveness in differentiating between compositionally similar rock types (P(granite) < 35% for both models). The observed performance patterns manifested most significantly in cases where rocks share similar mineral constituents in varying proportions, such as granite and sandstone. The uncertainty-aware variant’s performance metrics indicate that the primary challenge extends beyond the disparity between single-mineral training data and whole-rock classification objectives. Future research priorities should focus on the development of comprehensive mineral assemblage training datasets that capture spectral interactions within whole rock samples. Additionally, measuring the relative amounts of different minerals could enhance the analysis, providing more nuanced insights into rock composition and potentially improving classification accuracy. These findings indicate that improving classification accuracy requires addressing both fundamental data represen- tation challenges and the methodology for handling compositional uncertainty in rock sample analysis. 4.3. Limitation Although the method effectively detects the presence of specific minerals through their characteristic Raman spectral signatures, it faces several key challenges: (i) compositional ambiguity and (ii) classification constraints. Because different rock types can share similar mineral assemblages while having distinct geological origins and classifications, a classification overlap was observed in the results. As demonstrated by our confusion matrices (Fig- ure 6), both granites and sandstones exhibit significant classification overlap due to their shared mineral constituents, despite different proportions. The binary (presence/absence) nature of the current approach does not capture the subtle variations in mineral proportions that often distinguish different rock types. This limitation is particularly evident in the low precision rates for granite classification (<35%) and the systematic patterns of misclassifications observed between compositionally similar rock types. and knowledge-enhanced deep learning methodologies. Our quantitative analysis, based on a limited dataset of 30 samples, demonstrates the effectiveness of the hybrid mineral-to-rock classification framework. The 1D-CNN architecture achieved 98.37±0.006% accuracy in mineral identification, while the uncertainty-aware variant achieved 97.75±0.010% accuracy. The implementation of confidence thresholds in the knowledge system, governed by the weighting function introduced in this paper, provides systematic discrimination between compositionally similar rock Iye Szin Ang et al.: Preprint submitted to Elsevier Page 16 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach types. This is particularly evident in the classification of limestone samples, with a precision of 66.7%, recall of 57.1%, and an F1-score of 0.62. The methodological framework addresses some of the fundamental challenges in automated rock classification through the systematic integration of spectroscopic data analysis and expert geological knowledge. The achieved accuracy demonstrates the effectiveness of our knowledge-enhanced approach in compensating for data sparsity through expert rule integration. However, it is important to note that the small sample size (n=30) limits the generalizability of these findings, and further validation with a larger dataset is necessary. While this preliminary investigation establishes methodological feasibility, it also highlights clear pathways for future development. The transition from controlled laboratory conditions to conveyor belt operations presents opportunities for technological advancement. Integrating multiple sensing modalities and optimized data acquisition protocols could reduce the amount of laboratory experiments required, although laboratory validation will remain essential. These developments, coupled with our demonstrated success in mineral identification and classification, provide a robust framework for advancing automated geological characterization systems. This study serves as a foundational effort in the subfield of petrology, where open datasets are currently limited. By demonstrating the potential of our approach, we aim to inspire the creation of comprehensive, open-source mineral assemblage datasets. Such datasets would enable more robust validation of automated classification systems and further enhance the advantages of our knowledge-enhanced approach. Additionally, incorporating the relative ratios of minerals in the analysis could improve classification accuracy and address the compositional ambiguity observed in this study. The established methodology not only addresses current industrial needs but also lays the groundwork for more comprehensive rock type classification systems, positioning this research at the forefront of automated geological analysis. Iye Szin Ang et al.: Preprint submitted to Elsevier Page 17 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach Appendix A. Rock Composition Example 3 Jadeite Quartz Quartz Jadeite Orthoclase Jadeite Anorthite Quartz Annite Quartz Not a Granite because of the jadeite which Example 5 Annite Phlogopite Omphacite Albite Omphacite Quartz Annite Omphacite Omphacite Omphacite Not a Granite because of the omphacite which forms in metamorphic Example 8 Orthoclase Glaucophane Anorthite Albite Glaucophane Phlogopite Quartz Quartz Glaucophane Glaucophane Not a Granite because of the glaucophane which forms in metamorphic Example 9 Anorthite Quartz Staurolite Almandine Orthoclase Phlogopite Muscovite Albite Quartz Annite Not a Granite because of staurolite and al- mandine, both form in meta- Example 13 Sanidine Albite Sanidine Quartz Calcite Quartz Albite Anorthite Jadeite Annite Not a Sandstone because of sanidine and jadeite, sanidine is in magmatic rocks and jadeite Example 17 Quartz Anorthite Orthoclase Orthoclase Phlogopite Pyrope Quartz Omphacite Quartz Annite Not a Sandstone because of pyrope and om- phacite, both minerals form in Example 19 Glaucophane Albite Quartz Quartz Albite Glaucophane Muscovite Quartz Calcite Annite Not a Sandstone because of glaucophane which Example 22 Andalusite Calcite Calcite Albite Orthoclase Calcite Calcite Kyanite Pyrite Calcite Not a Limestone because of andalusite and kyanite which both form in Example 24 Dolomite Calcite Calcite Epidote Rhodochrosite Calcite Calcite Calcite Calcite Calcite Not a Limestone because of the presence of epidote it is more likely a mar- ble, epidote and marble are in Example 28 Sanidine Quartz Sanidine Calcite Dolomite Sanidine Calcite Calcite Calcite Calcite Not a Limestone because of sanidine which is forms in metamorphic rocks forms in metamorphic rocks is in metamorphic rocks metamorphic rocks metamorphic rocks metamorphic rocks in magmatic rocks Example 10 Almandine Annite Quartz Anorthite Albite Orthoclase Muscovite Garnet Quartz Annite Not a Granite because of Garnet morphic rocks No 1 2 3 4 5 6 7 8 9 Example 11 Quartz Calcite Ortholcase Albite Anorthite Pyrite Annite Phlogopite Muscovite Tourmaline Sandstone Example 12 Albite Orthoclase Anorthite Tourmaline Rutile Muscovite Quartz Calcite Annite Anorthite Sandstone Example 14 Pyrite Orthoclase Quartz Calcite Quartz Albite Anorthite Tourmaline Rutile Annite Sandstone Example 15 Albite Anorthite Anorthite Phlogopite Muscovite Annite Quartz Orthoclase Quartz Quartz Sandstone Example 16 Orthoclase Albite Anorthite Annite Muscovite Quartz Quartz Quartz Tourmaline Annite Sandstone Example 18 Albite Phlogopite Orthoclase Albite Muscovite Annite Calcite Quartz Albite Pyrite Sandstone Example 20 Quartz Muscovite Tourmaline Quartz Calcite Albite Tourmaline Annite Muscovite Orthoclase Sandstone Example 21 Calcite Quartz Dolomite Calcite Calcite Anorthite Albite Calcite Calcite Dolomite Limestone Example 23 Quartz Calcite Calcite Calcite Calcite Calcite Calcite Quartz Calcite Calcite Limestone Example 25 Calcite Calcite Calcite Calcite Calcite Calcite Calcite Calcite Calcite Calcite Limestone Example 26 Quartz Calcite Quartz Albite Calcite Pyrite Quartz Calcite Calcite Dolomite Limestone Example 27 Calcite Quartz Dolomite Calcite Calcite Calcite Dolomite Quartz Dolomite Quartz Limestone Example 29 Calcite Calcite Dolomite Albite Dolomite Calcite Calcite Calcite Dolomite Calcite Limestone Example 30 Calcite Calcite Dolomite Calcite Calcite Calcite Dolomite Calcite Calcite Calcite Limestone Example 1 Albite Anorthite Quartz Quartz Annite Muscovite Quartz Albite Annite Orthoclase Granite Example 2 Albite Quartz Annite Annite Muscovite Orthoclase Orthoclase Quartz Quartz Anorthite Granite Example 4 Orthoclase Muscovite Annite Orthoclas Albite Anorthite Muscovite Annite Quartz Phlogopite Granite Example 6 Annite Quartz Quartz Annite Albite Anorthite Orthoclase Albite Annite Muscovite Granite Example 7 Quartz Annite Muscovite Quartz Anorthite Orthoclase Quartz Albite Quartz Annite Granite Suggested rock composition of 30 samples. Table A.1 Iye Szin Ang et al.: Preprint submitted to Elsevier Page 18 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach Appendix B. Notations Table B.1 Table of Notation Symbol Description Measurements and Classifications M Sequence of measurements {m1, ..., mn} mi Individual measurement in sequence fi(M) Proportion of the i-th mineral in measurements δi Indicator function for mineral proportion constraints w Rl Classification weight for rock type rule Rl wmax Maximum classification weight w2nd Second-highest classification weight Mineral Assemblages ARl Weighted mineral assemblage for rule Rl ni Number of minerals from group Giin measurements pmin i Minimum expected proportion for i-th mineral pmax i Maximum expected proportion for i-th mineral Knowledge Base Components KB Knowledge base G Set of mineral assemblages R Set of rock type classification rules Rl Individual classification rule, where l∈{1, ..., L} H Hierarchical decision tree structure P Set of classification and composition parameters C Set of compositional and confidence constraints V, E Vertices and edges in decision tree Parameters αi Weighting coefficient representing relative importance of i-th mineral’s abundance θc Confidence threshold θd Separation threshold K, L, J Number of assemblages, rules, and constraints Mathematical Operators ∏ Product operator over a sequence of terms ⋀ Logical AND operator over a sequence of conditions Iye Szin Ang et al.: Preprint submitted to Elsevier Page 19 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach Table B.2 Mapping of Rock Classification Trees to Mathematical Framework Component Mathematical Form Granite Sandstone Limestone Mineral Groups (Gi∈G) Primary Groups G1, G2, ... Quartz, Feldspars, Micas Quartz, Feldspars, Calcite Calcite, Dolomite Weighted Assemblages (ARl) Major (Gi, w Rl, [pmin i , pmax i ]) (Quartz, 0.6, [0.20, 0.40]) (Quartz, 0.9, [0.70, 1.00]) (Calcite, 0.9, [0.90, 1.00]) Essential (Gi, w Rl, [pmin i , pmax i ]) (Feldspars, 0.8, [0.45, 0.80]) (Feldspars, 0.5, [0.05, 0.25]) (Dolomite, 0.7, [0.10, 0.50]) Accessory (Gi, w Rl, [pmin i , pmax i ]) (Micas, 0.3, [0, 0.15]) (Mica, 0.2, [0.02, 0.03]) (Quartz, 0.2, [0, 0.10]) Classification Rules (Rl∈R) Case Rules Rl(M) "Granite if Feldspars 45-80%" "Sandstone if Quartz >70%" "Pure Limestone if Calcite >90%" Constraints Cj(M, Gi, w Rl) "AND Quartz 20- 40%" "AND Feldspars 5- 25%" "OR Dolomitic if Dolomite 10-50%" Hierarchical Structure (H= (V, E)) Parent-Child (vp, vc) ∈E Feldspars →Ortho- clase/Albite Feldspars →Ortho- clase/Albite Limestone → Pure/Dolomitic Leaf Nodes v∈V Orthoclase, Albite, Anorthite Orthoclase, Albite, Anorthite Orthoclase, Albite, Anorthite Iye Szin Ang et al.: Preprint submitted to Elsevier Page 20 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach CRedi T authorship contribution statement Iye Szin Ang: Conceptualization, Methodology, Software, Formal analysis, Investigation, Data Curation, Writing – Original Draft, Writing – Review & Editing, Visualization. Martin Johannes Findl: Methodology, Data Curation, Resources, Validation, Writing – review & editing. Elisabeth Hauzinger: Project administration, Resources. Klaus Philipp Sedlazeck: Writing – review & editing, Validation, Supervision. Jyrki Savolainen: Writing – review & editing, Validation, Supervision. Ronald Bakker: Validation, Supervision. Robert Galler: Supervision, Funding acquisition, Project administration. Elmar Rueckert: Validation, Writing – review & editing, Supervision, Project administration. Code Availability The code developed in this research is available on Git Hub: https://github.com/iyeszin/rocks_evaluation. git. This repository contains all evaluation rock data and codes required to reproduce the results presented in this paper. Declaration of competing interest The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper. Acknowledgments We gratefully acknowledge support for the work in this paper from Austrian Federal Ministry for Climate Action, Environment, Energy, Mobility, Innovation and Technology (BMK) and Austrian Research Promotion Agency (FFG project number: FO999907606) as part of the FTI Circular Economy Initiative (3rd call for proposals, 2023) within open4innovation. Data availability Data is available from the RRUFF Project website: https://rruff.info/zipped_data_files/. We used high-quality unoriented Raman spectra from RRUFF. Declaration of Generative AI and AI-assisted technologies in the writing process During the preparation of this work, the authors used Anthropic’s Claude to assist with editing the manuscript and improving its readability and style. The authors then carefully reviewed, revised, and edited the content as needed, taking full responsibility for the final version of the publication. Iye Szin Ang et al.: Preprint submitted to Elsevier Page 21 of 23 Rock Classification through Knowledge-Enhanced Deep Learning: A Hybrid Mineral-Based Approach