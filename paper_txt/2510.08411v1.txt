Spectroscopy represents the ideal observational method to maximally extract information from galaxies regarding their star formation and chemical enrichment histories. However, absorption spectra of galaxies prove rather challenging at high redshift or in low mass galaxies, due to the need to spread the photons into a relatively large set of spectral bins. For this reason, the data from many state-of-the-art spectroscopic surveys suffer from low signal-to-noise (S/N) ratios, and prevent accurate estimates of the stellar population parameters. In this paper, we tackle the issue of denoising an ensemble by the use of unsupervised Deep Learning techniques trained on a homogeneous sample of spectra over a wide range of S/N. These methods reconstruct spectra at a higher S/N and allow us to investigate the potential for Deep Learning to faithfully reproduce spectra from incomplete data. Our methodology is tested on three key line strengths and is compared with synthetic data to assess retrieval biases. The results suggest a standard Autoencoder as a very powerful method that does not introduce systematics in the reconstruction. We also note in this work how careful the analysis needs to be, as other methods can – on a quick check – produce spectra that appear noiseless but are in fact strongly biased towards a simple overfitting of the noisy input. Denoising methods with minimal bias will maximise the quality of ongoing and future spectral surveys such as DESI, WEAVE, or WAVES. Key words: techniques: spectroscopic – methods: data analysis – galaxies: statistics – galaxies: evolution – galaxies: stellar content – galaxies: fundamental parameters lation synthesis (see, e.g. Walcher et al. 2011; Conroy 2013). In this regard, it is not uncommon to need values of S/N per resolution element above ≳20-30, if not higher, for de- tailed analyses of subtle differences in the populations, such as variations of chemical abundances or the initial mass func- tion (e.g. La Barbera et al. 2013, 2017; Ferreras et al. 2019). In this regard, spectroscopic surveys tend to be optimised to produce large volumes of data, at the cost of a lower S/N, and so, any algorithm aimed at increasing the S/N of the data proves a very valuable tool, especially with the ongoing and upcoming surveys such as DESI (DESI Collaboration et al. 2025), WEAVE (Jin et al. 2024) or WAVES (Driver et al. 2019). Galaxy spectra in the wavelength interval from near ultra- violet to near infrared encode a vast amount of informa- tion regarding the properties of the underlying stellar pop- ulations. The continuum and absorption lines of the photo- spheres of constituent stars leave their imprint on the inte- grated spectra, and represent the workhorse of galaxy forma- tion studies concerning the star formation and chemical en- richment histories. Spectroscopic surveys of galaxies, such as the Sloan Digital Sky Survey (York et al. 2000) have greatly helped deepen our understanding of galaxy formation. How- ever, spectroscopy requires large integration times, as the faint light from galaxies is spread with respect to wavelength. Often times, spectra have been used – mainly by cosmologists – as a tool to derive redshift and thus determine the large- scale distribution of galaxies. However, exploring the galaxies themselves through their stellar populations requires deeper data, at a higher signal-to-noise (S/N) ratio, in order to com- pare the observations with detailed models of stellar popu- The actual S/N of an observation is borne out of the com- petition between the photons from the galaxy and spurious photons or counts coming from unwanted sources, such as the background sky, airglow, detectors and reduction artifacts, etc. Increasing the S/N of a single spectrum is typically not feasible unless models are used, therefore introducing large systematics. Our approach to this problem starts from a large ensemble of spectra taken by the same instrument and fol- lowing the same reduction process. The ensemble should also include a large amount of high quality (i.e. high S/N) data, ⋆E-mail: oc00149@surrey.ac.uk † Corresponding author: ignacio.ferreras@iac.es © 2025 The Authors 2 Camilleri et al. so that the method can somehow interpolate among the en- semble members to produce optimised versions of the data. Traditional data driven methods, such as Principal Compo- nent Analysis, have been applied to stellar and galaxy spec- tra, for instance to remove the emission lines from airglow (Wild & Hewett 2005). These methods are commonly used for classification purposes (Madgwick et al. 2003; Mc Gurk et al. 2010) and can also help in the interpretability of the information content, for instance by exploring the resultant latent space (e.g., Sharbaf et al. 2023, 2025). However, as a linear method, PCA is less versatile to encode and model the many intricacies of the spectra in a large ensemble. is presented in § 5. Finally, our concluding remarks are given in § 6. spectra of the Sloan Digital Sky Survey (York et al. 2000). The data include a large number of spectra (of order 1 mil- lion), and most importantly covers a wide range of S/N, with a large number of high quality data at a S/N higher than 10-20, and many spectra at lower S/N. This represents an ideal training sample as the data processing is homoge- neously performed, minimising biases, and covers all types of evolutionary stages of galaxies, mass, morphology, etc. Moreover, each observation includes, in addition to the ac- tual spectrum, a best fit model that can be adopted as a synthetic case to which noise is added, as we will show be- low. The sample is the same as the one presented in Sharbaf et al. (2023) and the motivation behind the constraints re- garding the quality of the data as an ensemble is identical. For instance, in order to set this exercise in the best de- fined scenario, we include a constraint in (stellar) velocity dispersion between 100 and 150 km s−1 as a wider range will also introduce the expected bias in effective spectral reso- lution caused by the kinematic kernel. The data are taken from SDSS Data Release 16 (Ahumada et al. 2020), and cor- respond to single fibre measurements of the central parts of galaxies (3 arcsec diameter), at spectral resolution R ∼2, 000 (Smee et al. 2013). The targets are selected as completely as possible down to a Petrosian flux level for the target galaxy in the SDSS-r band of r < 17.77 AB (Strauss et al. 2002). The data were further constrained in redshift, z∈[0.05,0.1] and in S/N measured as an average within the SDSS-r band higher than 15 per pixel (∆log(λ/Å) = 10−4). The total sam- ple comprises 68,794 spectra, which were retrieved from the main SDSS database, de-redshifted and de-reddened regard- ing foreground dust absorption from the Milky Way, following a standard Fitzpatrick (1999) attenuation law. To remove the variations caused by different stellar mass and redshift of the galaxies, all spectra are normalized to the same average flux in 6,000-6,500Å window, in the rest-frame. The spectral range is restricted to the rest-frame wavelength λ ∈Å. Finally, for one of the tests, we explore the denoising procedure when training on data without con- tinuum. For that purpose, we take the robust high percentile method of Rogers et al. (2010) to define the continuum that is removed from each spectra for this test case. For more details about the sample, please see Sharbaf et al. (2023). Deep Learning (DL) methods are seeing a rapid uptake in use throughout astronomy, helping to address problems that traditional data-driven approaches struggle with. For exam- ple, DL has been applied to galaxy and stellar spectra for classification purposes (e.g., Folkes et al. 1996; Fabbro et al. 2018; Wu et al. 2024), dimensionality reduction (e.g., Portillo et al. 2020), recovery of spectra with bad quality (e.g., Wang et al. 2017), general analysis (e.g., Lovell et al. 2019; Melchior et al. 2023) or in the search for anomalies (e.g., Baron & Poz- nanski 2017; Liang et al. 2023). In this paper, we adopt a set of DL algorithms, each trained on a large set of galaxy spectra from the Legacy part of SDSS, and then assess their ability to increase the S/N of input spectra. These models are unsuper- vised, and in contrast to works like Scourfield et al. (2023), do not rely on adding synthetic noise to training data. Instead, the denoising effects seen are emergent, ultimately stemming from information bottlenecks and aided by the formulation of the objective function. Furthermore, we experiment with the reconstruction of spectra from incomplete data and attempt to explain deep model decision making. Please note it is important to ensure that the process does not alter the sample in a systematic way. We also emphasise that this method is not a smoothing process, where the S/N can be increased at the cost of a lower spectral resolution. A similar type of work has been recently presented in Scour- field et al. (2023), mainly focussed on retrieval of emission line data. The authors conclude that a Variational Autoen- coder performs better than PCA, and study the effect of de- noising DESI data from an SDSS-trained set regarding the relationship between stellar mass and (gas phase) metallicity. Melchior et al. (2023) also consider the use of autoencoders to analyse galaxy spectra, and look into the interpretability of latent space, with results mostly focused on emission lines, which is where the spectral variance fully dominates in star- forming and AGN systems. The authors indeed suggest that these methods can be adopted to denoise ensembles of spec- tra. This work complements these previous studies, turning to the more challenging case of the absorption line spectra, that is commonly used to constrain the stellar population content and the past star formation history. We also consider the issue of potential biasing of the denoised data by use of synthetic spectra that are adopted as ground truth to assess the fidelity of the recovered measurements. 3 METHODOLOGY: DENOISING THE SPECTRA 3.1 Butterworth Filtering The structure of the paper is as follows, we give a brief presentation of the working sample in § 2, along with a de- scription of the various methods tested for denoising in § 3. The comparison of retrieved and original data is shown in § 4, including a comparison of synthetic data with added noise. A brief discussion of the explainability of the DL performance The Butterworth filter (BF) is a classical signal processing approach used to selectively attenuate unwanted frequencies within a general signal. Its maximally flat frequency response in the passband supresses signal distortion, making it a pop- ular choice in a range of domains. The squared magnitude of the frequency response, |H(ω)|2, at angular frequency, ω, is MNRAS 000, 1–9 (2025) Emergent Denoising of SDSS Galaxy Spectra 3 4 Camilleri et al. SDSS Synthetic Worthey & Ottaviani (1997), and the traditional Mgb index of the Lick system (Trager et al. 1998). The figure of merit (∆) is defined for each line strength measurement as follows: we produce a vector with the resid- uals of the output and the reference for each spectrum: δs(Ii) ≡[Ii,s −Ii,r], where s represents the output spec- trum and r the reference spectrum. The mean or median of the ensemble {δs(I)} are expected to be close to zero, and the standard deviation represents how well the data are re- covered. Therefore, we adopt the standard deviation of the residuals as our figure of merit: 0.0 0.2 0.4 0.6 0.8 (S/N=5) 0.0 0.2 0.4 0.6 0.8 Dn(4000) NW CS FS BF NW-S NW CS FS BF NW-S H F O N 1 2 3 (S/N=5) 1 2 3 ∆(I) ≡ p ⟨δ2(I)⟩−⟨δ(I)⟩2. (5) Also note that the reference case, Ii,r], is the comparison spectra, that can be defined in two ways, it is either the (“noiseless”) best fit data (∆O), or the noisy original SDSS data (∆N). The former allows us to quantify the denoising process, whereas the latter is used to test overfitting. Fig. 2 shows the residual statistic measured at a S/N=5 (as an average over all spectra with S/N∈) for the recon- struction of an additional, unseen set of real SDSS spectra (left) or a set of synthetic spectra (right). In the case with real data, we only show the data points corresponding to ∆O, as ∆N would trivially compare the noisy data with itself. For the synthetic case, we can compare the residual statistic for the “ground truth” case (∆O), and for a noisy realization of this ideal case, with Gaussian noise that shows the same S/N as the original data (∆N). In this framework, the case ∆N < ∆O would be indicative of a kind of overfitting. The opposite would be suggestive of true denoising. For reference, the value of ∆O for the comparison of noiseless and noisy synthetic data – i.e. the variance expected by the presence of noise in the spectra – is shown in each case as a horizontal dashed blue line. The performance of the different methods is comparable with the SDSS data reconstruction (left panels), although the BF method appears to fare worse. The more interesting results are found for the synthetic data (right panels), where we can discriminate between the recovery of the input, noisy data (∆N, blue stars), or a more desirable reconstruction of the original, noiseless, spectra. (∆O, red circles). One thing that stands out quite clearly is that the 4000Å break strength is poorly determined by the CS method. This may be quite expected, as the Dn(4000) is wider than the other two and relies on the continuum. However, we performed this test as there is a well-known de- generacy between parameters, so that, for instance, Dn(4000) indices are correlated with, e.g, Mgb. The strong covariance between line strengths found in Ferreras et al. (2023) indi- cates that the absorption line spectrum would encode similar information as the continuum. This experiment suggests that discovering and leveraging this trend is challenging for DL methods. The figure also shows an uncanny inversion of the star - circle order (i.e. ∆N vs ∆O) in the BF method with respect to the other algorithms. We emphasize that this method does not use information from the ensemble, and only relies on a careful filtering of high frequencies, many of which would be ascribed to noise. This would be equivalent to a truncation in a Fourier series. The results presented here reveal that the BF method tends to overfit, so that it produces an optimal reconstruction when using noisy data as input, but under- performs when the noiseless synthetic data are considered. NW CS FS BF NW-S NW CS FS BF NW-S 0.5 1.0 1.5 2.0 2.5 3.0 (S/N=5) 0.5 1.0 1.5 2.0 2.5 3.0 Mgb NW CS FS BF NW-S NW CS FS BF NW-S Emergent Denoising of SDSS Galaxy Spectra 5 Dn(4000) H F Dn(4000) H F Mgb Mgb 0.0 0.1 0.2 0.3 0.4 O Noise NW CS FS BF NW-S Noise NW CS FS BF NW-S 0.4 0.8 1.2 1.6 0.0 0.5 1.0 1.5 2.0 0.4 0.8 1.2 0.00 0.15 0.30 0.45 O 0.0 0.4 0.8 1.2 1.25 1.50 1.75 1 2 2 3 4 10 20 10 20 10 20 0.0 0.1 0.2 0.3 0.4 N 0.4 0.8 1.2 1.6 0.0 0.5 1.0 1.5 2.0 0.4 0.8 1.2 0.00 0.15 0.30 0.45 N 0.0 0.4 0.8 1.2 1.25 1.50 1.75 Dn(4000) 1 2 3 10 20 S/N g-band 10 20 S/N g-band 10 20 S/N g-band 6 Camilleri et al. 0.8 The other two indices show a more characteristic behaviour between the BF (overfitting) algorithm and the DL method. Note that both HδF and Mgb produce distributions closer to the ground truth with FS, whereas BF closely resembles the wider shape of the histogram of noisy data. From these tests, we conclude that a DL method is successful at improving the quality of galaxy spectra if a representative, large ensemble with a wide range of S/N, including high quality data with the same instrumental / data characteristics are available. 2.00 No Noise Noise FS BF 0.8 0.7 1.75 0.7 0.6 1.50 0.6 0.5 1.25 0.5 0.4 1.00 0.4 0.3 0.75 0.3 0.2 0.2 0.50 0.1 0.1 0.25 0.0 0.0 0.00 1.5 2.0 Dn(4000) 0 0 5 EXPLAINING MODEL BEHAVIOUR Emergent Denoising of SDSS Galaxy Spectra 7 1.100 1.3 1.075 1.2 1.050 1.1 1.025 1.000 1.0 0.975 0.9 0.950 0.8 0.925 0.7 0.900 0.6 1.4 3800 3900 4000 4100 4200 4300 4400 5100 5200 5300 5400 5500 6400 6450 6500 6550 6600 6650 6700 6750 6800 1.075 1.3 1.050 1.2 1.025 1.1 1.000 1.0 Flux F( ) arb. units 0.975 0.9 0.8 0.950 0.7 0.925 1.3 3800 3900 4000 4100 4200 4300 4400 5100 5200 5300 5400 5500 6400 6450 6500 6550 6600 6650 6700 6750 6800 1.8 1.2 1.6 1.1 1.0 1.4 0.9 0.8 1.2 0.7 0.6 1.0 0.5 2.0 3800 3900 4000 4100 4200 4300 4400 5100 5200 5300 5400 5500 6400 6450 6500 6550 6600 6650 6700 6750 6800 1.2 1.8 1.1 1.6 1.0 1.4 0.9 1.2 0.8 1.0 3800 3900 4000 4100 4200 4300 4400 5100 5200 5300 5400 5500 6400 6450 6500 6550 6600 6650 6700 6750 6800 1.4 1.3 1.2 1.3 1.1 1.2 1.0 1.1 0.9 1.0 0.8 0.7 0.9 8 Camilleri et al. Dn(4000) H F Mgb ing for SDSS-III has been provided by the Alfred P. Sloan Foundation, the Participating Institutions, the National Sci- ence Foundation, and the U.S. Department of Energy Office of Science. The SDSS-III web site is http://www.sdss3.org/. 0.5 1.0 1.5 0.1 0.2 0.3 0.4 O 0.5 1.0 1.5 DATA AVAILABILITY This work has been fully based on publicly available data: galaxy spectra were retrieved from the SDSS DR17 archive and stellar population synthesis models can be obtained from the respective authors. Code for each model presented in this paper will be made openly available on Git Hub. 10 20 10 20 10 FS(MAE) FS(MSE) 0.5 1.0 1.5 0.1 0.2 0.3 0.4 N 0.5 1.0 1.5