The rise of digital medical imaging, like MRI and CT, demands strong encryption to protect patient data in telemedicine and cloud storage. Chaotic systems are popular for image encryption due to their sensitivity and unique char- acteristics, but existing methods often lack sufficient security. This paper presents the Three-dimensional Diffusion Algorithm and Deep Learning Image Encryption system (TDADL-IE), built on three key elements. First, we propose an enhanced chaotic generator using an LSTM network with a 1D-Sine Quadratic Chaotic Map (1D-SQCM) for better pseudorandom sequence generation. Next, a new three-dimensional diffusion algorithm (TDA) is applied to encrypt permuted images. TDADL-IE is versatile for images of any size. Experiments confirm its effec- tiveness against various security threats. The code is available at https://github.com/Quincy QAQ/TDADL-IE. Index Terms—Deep learning; Medical image encryption; Chaotic map I. INTRODUCTION The rise of medical imaging and telemedicine has increased the need for secure digital image transmission and storage. Medical images like MRI, CT, and ultrasound contain sensitive patient data crucial for diagnosis and treatment. Without strong encryption, these images are vulnerable to unauthorized access and breaches, especially over unsecured networks or in cloud storage. Protecting this data is essential for patient privacy and required by regulations like HIPAA. Traditional text-oriented encryption methods are ineffective for medical images due to their high inter-pixel correlation, large data size, and complex formats. Chaotic systems offer a promising solution for developing robust and efficient image encryption techniques . Chaotic systems, known for their deterministic randomness, ergodicity, and sensitivity to initial conditions, are ideal for cryptographic applications like generating pseudo-random se- quences for image encryption . Although one-dimensional * Corresponding authors: li zimeng@szpu.edu.cn, xuhangc@hzu.edu.cn This work was supported in part by the National Natural Science Foundation of China (Grant No. 62501412), in part by Shenzhen Medical Research Fund (Grant No. A2503006), in part by Shenzhen Polytechnic University Research Fund (Grant No. 6025310023K) and in part by Guangdong Basic and Applied Basic Research Foundation (Grant No. 2024A1515140010). capabilities of Long Short-Term Memory (LSTM) net- works, we engineer a novel chaotic sequence generator. This generator exhibits an expanded chaotic regime, su- perior entropy, and refined temporal correlations, culmi- nating in substantially enhanced randomness and cryp- tographic robustness. 3) Addressing the distinct requirements of diffusing non- square and color images, where inter-channel corre- lations and varying dimensions pose significant chal- lenges, we present the three-dimensional diffusion algo- rithm (TDA). This mechanism amalgamates forward and backward diffusion processes with inter-channel pixel interactions. Such a design ensures that minute alter- ations in the plaintext cascade comprehensively through- out the ciphertext, thereby significantly amplifying both key sensitivity and plaintext sensitivity. introducing nonlinear changes that influence system evolution and enhance complex dynamics. The memory cell integrates these inputs, updating its state to capture long-term depen- dencies and produce intricate, high-dimensional sequences. Altogether, these elements form a robust nonlinear mechanism for modeling and creating complex temporal sequences with chaotic traits. Leveraging these properties, we introduce a hybrid chaotic sequence generator that synergistically combines the 1D Sine- Cosine-Exponential Map (1D-SQCM) with the temporal mod- eling capabilities of a BLSTM network. The 1D-SQCM, selected for its inherent characteristics of high entropy and pronounced sensitivity to initial conditions, is defined as: xn+1 = sin( a2 sin(xn)), (1) where xn denotes the state variable at iteration n, and a is a system control parameter. By subsequently processing the output of the 1D-SQCM through the BLSTM network, we aim to generate sequences that are not only temporally correlated and statistically rich but also exhibit significant phase space divergence. This integrated methodology preserves the funda- mental randomness of the chaotic map while empowering the BLSTM to adaptively learn and amplify the complexity and unpredictability of the generated sequences. II. METHODOLOGY TDADL-IE is a new encryption algorithm for multi- medical images, using a 1D Sine-Cosine-Exponential Map (1D-SQCM) and neural network enhancement. Its flowchart is shown in the learning rate and the length of input subsequences for training, are optimized. The BLSTM model is then trained using Xtrain to learn its underlying temporal patterns and statistical properties. Upon completion of this training phase, the BLSTM model is equipped to generate enhanced chaotic sequences for the encryption process. Step 2: Hybrid Chaotic Sequence Generation for En- cryption. For the encryption process, the secret keys Keyx1, Keyy1, Keya, and Key N0 are employed. The generation proceeds as follows: for i = 1, 2, . . . , L. 3) Matrix Reshaping: The resulting one-dimensional se- quences X, Y , and Z are reshaped into m×n matrices, denoted X2D, Y2D, and Z2D, respectively. These matrices are subsequently employed in the TDA module. The se- quence s is reserved for the Index Shuffling Algorithm. This multi-stage derivation ensures that distinct, complex pseudo-random sequences are available for different crypto- graphic operations, enhancing the overall security. B. Index Shuffling Algorithm (ISA) The Index Shuffling Algorithm (ISA) implements a pixel- level permutation to obfuscate spatial correlations within the input image. This process is applied to each m × n image or image channel independently, using the chaotic sequence s (of length mn) derived as described in Section II-A (Step 3). The ISA proceeds as follows: 1) 1D-SQCM Sequence Generation: A primary chaotic sequence, denoted XSQCM, of length 2mn is generated using the 1D-SQCM (Eq. (1)). The map is initialized using Keyx1 as the initial state x0, and Keya serves as the control parameter. The keys Keyy1 and Key N0 may influence aspects such as the number of initial iterations to discard prior to collecting sequence values for encryption. 2) BLSTM Sequence Enhancement: The trained BLSTM model is then utilized to produce a secondary chaotic sequence, XBLSTM, also of length 2mn. This sequence can be generated by feeding an initial seed (derived from the keys or from a segment of XSQCM) to the BLSTM and allowing it to predict subsequent values. 3) Sequence Concatenation: The two sequences, XSQCM and XBLSTM, are horizontally concatenated to form a hybrid chaotic sequence Shybrid of total length 4mn. This hybrid sequence benefits from both the fundamental chaotic properties of the 1D-SQCM and the learned complexity introduced by the BLSTM. The length mn typically corresponds to the number of pixels in a single channel of an image of size m×n. The total length 4mn prepares for processing data equivalent to an m×n image with four components per pixel (e.g., RGBA) or four distinct m × n sequences for cryptographic operations. Step 3: Chaotic Sequence Processing and Derivation. The hybrid chaotic sequence Shybrid of length 4mn, generated as described in Step 2, is subsequently processed to derive tailored sequences for the various stages of the encryption algorithm. This processing is performed as follows: 1) Vectorization: The m × n pixel data of an image (or an individual channel thereof) is flattened into a one- dimensional vector P of length mn. 2) Permutation Index Generation: The chaotic sequence s is utilized to derive a set of permutation indices. A common method involves obtaining the indices that would sort the elements of s. Let these indices be Idx = [idx1, idx2, . . . , idxmn]. 3) Pixel Scrambling: The pixels in vector P are reordered according to these indices. Specifically, the j-th pixel in the permuted vector P ′ is P(idxj). This operation effectively scrambles the original pixel arrangement. 4) Reshaping: The permuted vector P ′ is reshaped back into its original m×n two-dimensional structure, yield- ing the shuffled image (or channel). This permutation step significantly enhances the algorithm’s resistance to statistical attacks by decorrelating adjacent pixels. C. Three-dimensional Diffusion Algorithm (TDA) The Three-dimensional Diffusion Algorithm (TDA) is de- signed to spread pixel information across spatial dimensions and color channels in images m×n. It uses forward and back- ward diffusion passes to ensure changes to a single plaintext pixel impact many ciphertext pixels, ensuring diffusion. The forward pass processes pixels in raster order e.g. from top-left (1, 1) to bottom-right (m, n), while the backward pass goes in the reverse direction e.g. from (m, n) to (1, 1). TDA’s cross-channel pixel interactions boost encryption strength, especially for color images, by ensuring diffusion oc- curs across color planes. Conceptually shown in Fig. 3, a pixel in one channel is influenced by neighboring pixels in other channels. For instance, during diffusion, a Green (G) channel pixel at (i, j) is updated using nearby Red (R) channel pixels (e.g. from (i−1, j) and (i, j−1)), its previous G neighbor, and a key-derived element. A Blue (B) channel pixel may also rely on G channel values. This inter-channel dependency is vital to counteract independent channel analysis. TDA’s operations and updates are detailed in Algorithm 1, using key-dependent matrices X2D, Y2D, and Z2D. 1) Sequence Partitioning: The sequence Shybrid is parti- tioned into four sub-sequences, s, x, y, and z, each of length L = mn. (Here, L = mn represents the number of elements in each sub-sequence, corresponding to the pixel count of a single-channel m × n image). 2) Derivation of Diffusion Sequences: From the sub- sequences x, y, and z, three new sequences, X, Y , and Z, also of length L = mn, are computed using the transformations defined in Eq. (2).    X(i) = mod(⌊x(i) · y(L−i+1) · 109⌋, 256) + 1, Y (i) = mod(⌊x(L−i+1) · y(i) · 109⌋, 256) + 1, Z(i) = mod(⌊z(i) · 109⌋, 256) + 1, (2)   Algorithm 1 Three-dimensional Diffusion Algorithm Input: The scrambled image A with size M × N and the chaotic matrices X2D, Y2D, and Z2D 1: C(1, 1, 1) ←mod(A(1, 1, 1) + X2D(1, 1), 256) 2: C(1, 1, 2) ←mod(A(1, 1, 2) + Y2D(1, 1), 256) 3: C(1, 1, 3) ←mod(A(1, 1, 3) + Z2D(1, 1), 256) 4: for j = 2 to N do 5: C(1, j, 1) ←mod(A(1, j, 1) + X2D(1, j) + C(1, j − 1, 1) + C(1, j −1, 3), 256) 6: C(1, j, 2) ←mod(A(1, j, 2) + Y2D(1, j) + C(1, j − 1, 2) + C(1, j −1, 1), 256) 7: C(1, j, 3) ←mod(A(1, j, 3) + Z2D(1, j) + C(1, j − 1, 3) + C(1, j −1, 2), 256) 8: end for 9: for i = 2 to M do G R B Fig. 3. The Illustration of Three-dimensional Diffusion Algorithm (TDA) 10: C(i, 1, 1) ←mod(A(i, 1, 1) + X2D(i, 1) + C(i − 1, 1, 1) + C(i −1, 1, 3), 256) 11: C(i, 1, 2) ← mod(A(i, 1, 2) + Y2D(i, 1) + C(i − 1, 1, 2) + C(i −1, 1, 1), 256) 12: C(i, 1, 3) ← mod(A(i, 1, 3) + Z2D(i, 1) + C(i − 1, 1, 3) + C(i −1, 1, 2), 256) subtraction for modular addition). The cross-channel dependencies are also reversed according to the defined inverse rules. 3) Inverse Index Shuffling: The inverse permutation, derived from the same chaotic sequence s by determining the reverse mapping of indices, is applied to the diffused image to restore the original pixel order. The successful recovery of the plaintext image hinges on the precise application of these inverse steps and the availability of the identical secret keys used during encryption. 13: end for 14: repeat 15: for i = 2 to M do 16: for j = 2 to N do 17: C(i, j, 1) ←mod(A(i, j, 1)+X2D(i, j)+C(i, j− 1, 3) + C(i −1, j, 3), 256) 18: C(i, j, 2) ←mod(A(i, j, 2)+Y2D(i, j)+C(i, j − 1, 1) + C(i −1, j, 1), 256) 19: C(i, j, 3) ←mod(A(i, j, 3)+Z2D(i, j)+C(i, j − 1, 2) + C(i −1, j, 2), 256) 20: end for III. EXPERIMENTAL RESULTS This section evaluates the proposed cryptosystem, focusing on the efficiency and security of the TDADL-IE algorithm and the performance characteristics of the 1D-SQCM chaotic map. 21: end for 22: until The image encryption process is complete. 23: Output: The encrypted image C A. Experimental Setup The validation consists of analyzing the 1D Sin-Cos Pi Hyperchaotic Map (1D-SQCM) and evaluating the TDADL- IE encryption algorithm. The chaotic behavior of 1D-SQCM is compared to three one-dimensional chaotic maps Table I and two-dimensional systems. For TDADL-IE, three standard grayscale test images, ”IMG1”, ”IMG2”, and ”IMG3” of sizes M × N, e.g., and 512 × 512 pixels , are used. It’s compared with state-of-the-art encryption techniques – using standard metrics. Experiments ran on an AMD Ryzen 7 7800X3D CPU at 4.20 GHz, 32 GB RAM, with Windows 11 and MATLAB R2024a. D. Decryption Algorithm The decryption procedure for TDADL-IE is designed as the exact inverse of the encryption process. Given that the core operations—chaotic sequence generation, index shuffling (per- mutation), and three-dimensional diffusion (typically involving operations such as XOR and modular arithmetic)—are deter- ministic and reversible when the correct secret keys (Keyx1, Keyy1, Keya, Key N0) are known, the original plaintext image can be perfectly reconstructed. The decryption involves: B. Performance Analysis of the 1D-SQCM Chaotic Map This subsection presents a comparative analysis of the chaotic dynamics exhibited by the proposed 1D-SQCM and other existing chaotic maps, with detailed comparisons pro- vided in Table I. The objective is to demonstrate the enhanced chaotic properties of 1D-SQCM. 1) Lyapunov Exponent Analysis: The Lyapunov exponent (LE) quantifies the sensitivity of a dynamical system to infinitesimal perturbations in its initial conditions, with posi- tive LEs indicating chaotic behavior. Figure 4 illustrates the 1) Chaotic Sequence Regeneration: The same set of chaotic sequences (s, X2D, Y2D, Z2D) are regenerated using the secret keys identically to the encryption phase. 2) Inverse Three-dimensional Diffusion: The TDA oper- ations are applied in reverse. This typically involves processing in the reverse order of diffusion passes (e.g., inverse backward pass followed by inverse forward pass) and applying the mathematical inverse of each encryp- tion operation (e.g., XOR is its own inverse; modular TABLE I TESTED MAPS. TABLE II NIST TEST RESULTS OF 1D-SQCM. Name Mathematical expressions Parameter settings Test index P−value Result 1D-SQCM xn+1 = sin( a sin(xn)) a∈(0, ∞) sine xn+1 = b × sin(πxn) b∈(0, ∞) Frequency (Monobit) Test 0.0909 PASS Frequency Test within a Block 0.0711 PASS Runs Test 0.2368 PASS Longest Run of Ones in a Block Test 0.4190 PASS Binary Matrix Rank Test 0.7981 PASS Discrete Fourier Transform (Spectral) Test 0.3504 PASS Non-overlapping Template Matching Test 0.2368 PASS Overlapping Template Matching Test 0.2757 PASS Maurers Universal Statistical Test 0.9780 PASS Linear Complexity Test 0.8676 PASS Serial Test 0.8343 PASS Approximate Entropy Test 0.5341 PASS Cumulative Sums (Cusums) Test 0.2896 PASS Random Excursions Test 0.8623 PASS Random Excursions Variant Test 0.8676 PASS 1-DFCS xn+1 = cos((ηxn+1)2+1) sin((ηxn+1)2+1)+2 η∈(0, ∞) 1D-Chebyshev xn+1 = cos(k × arccos(xn)) k∈(0, ∞) Lyapunov exponents for the 1D-SQCM and other bench- marked 1D chaotic maps across a control parameter range of (0, 10000). The results demonstrate that the 1D-SQCM maintains positive Lyapunov exponents throughout this range. Furthermore, these values are consistently larger than those of the compared chaotic maps, signifying robust chaotic charac- teristics and heightened sensitivity to initial conditions, which are desirable for cryptographic applications. BLSTM Training Loss Curve x-sequence Min Loss 100 80 60 40 10 20 Min: 1.78e-04 Reference (1e-4) 0 8 0 100 200 300 400 6 Fig. 5. BLSTM training loss 4 1D-SQCM 1-DFCS sine 1D-Chebyshev y=0 {Xtrue} and {Xpred} over extended predictions highlights the long-term unpredictability of the 1D-SQCM, a trait of robust chaotic systems. 2 0 C. Security and Performance Analysis of TDADL-IE Cryp- tosystem 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 Control pramaters of different 1D-chaotic maps. 1) Key Space Analysis: A fundamental requirement for robust cryptographic security against exhaustive search attacks is a key space substantially larger than 2100. The TDADL- IE cryptosystem utilizes four secret keys with the following initial theoretical ranges: Keyx1 ∈(0, 1), Keyy1 ∈(0, 1), Keya ∈(0, ∞), and Key N0 ∈(2000, ∞). In a practical digital implementation, these continuous ranges are discretized based on the precision of the numerical representation. Con- sequently, the effective discrete key space is vast, estimated to be approximately 2208. This significantly surpasses the afore- mentioned security threshold, rendering brute-force attacks computationally infeasible and thereby providing a high level of protection. 2) Differential Attack Analysis: Plaintext and Key Sensitiv- ity: An encryption algorithm’s resilience to differential attacks is measured by its sensitivity to small changes in plaintext or key, assessed via NPCR and UACI metrics. Ideal NPCR and UACI values are about 99.6% and 33.4% for 8-bit grayscale images with random-like cipher images. The TDADL-IE al- gorithm’s NPCR and UACI scores when altering a single bit are high and near these ideal levels, indicating strong Fig. 4. The Lyapunov exponent of 1D-SQCM, 1-DFCS, Sine and 1D- Chebyshev map. 2) NIST SP 800-22 Statistical Test Suite: The randomness of the sequences generated by the 1D-SQCM was rigorously evaluated using the NIST SP 800-22 statistical test suite. This suite comprises a set of tests designed to detect deviations from true randomness in binary sequences. Table II presents the P- values obtained from these tests applied to sequences derived from the 1D-SQCM output. For all generated sequences, the P- values consistently exceed the standard significance threshold of 0.01. 3) Deep Learning-based Predictability Assessment: The 1D-SQCM’s output was analyzed using a Bidirectional Long Short-Term Memory (BLSTM) network, with training details in Fig. 6. The low root-mean-square error (RMSE) and loss function values suggest the BLSTM’s ability to learn the short-term patterns of the chaotic sequence. A comparison between the actual sequence {Xtrue} and the BLSTM predic- tion {Xpred} is presented in Fig. 6. The divergence between